/*! PILab 24-01-2021 (c) 2021 propertyindicators@gmail.com */

"use strict";var __decorate=this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g},__metadata=this&&this.__metadata||function(a,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),model_result_1=require("./model.result"),model_addr_1=require("./model.addr"),model_params_1=require("./model.params"),service_cosmo_1=require("./service.cosmo"),rxjs_1=require("rxjs"),ResultSavingView=function(){function a(a){this.serviceCosmo=a}return a.prototype.ngOnInit=function(){var a=this;this.evaluationResultSubscription=this.evaluationResultChanged.subscribe(function(){a.showMessage="none"}),this.serviceCosmo.InitCn()},a.prototype.ngOnDestroy=function(){this.evaluationResultSubscription.unsubscribe()},a.prototype.save=function(){var a=this,b=this.CookForCosmoOjectParamsAndEvaluationResults();this.serviceCosmo.SaveNewEvaluationObjectsWithResultsInNewUserCosmoDoc(b).then(function(b){a.message="Объект успешно добавлен в Ваши объекты (Id = "+b.id+")",a.messageColor="#000058"}).catch(function(b){a.message=b,a.messageColor="#b30000"}),this.showMessage="inline"},a.prototype.CookForCosmoOjectParamsAndEvaluationResults=function(){var a=[(new Date).toUTCString()];return a.push(this.result.CosmoObject),{P:{Addr:this.addr.CreateCosmoObject(),Params:this.params.CreateParamsChoiceForCosmo(),Coefs:this.params.CreateParamsCoefsForCosmo()},E:{evaluationResult:a}}},__decorate([core_1.Input(),__metadata("design:type",model_addr_1.AddrModel)],a.prototype,"addr",void 0),__decorate([core_1.Input(),__metadata("design:type",model_params_1.ParamsModel)],a.prototype,"params",void 0),__decorate([core_1.Input(),__metadata("design:type",model_result_1.ResultViewModel)],a.prototype,"result",void 0),__decorate([core_1.Input(),__metadata("design:type",rxjs_1.Observable)],a.prototype,"evaluationResultChanged",void 0),a=__decorate([core_1.Component({selector:"comp-save-result",moduleId:module.id,templateUrl:"component.save-result.html",styleUrls:["component.addr.css"],providers:[service_cosmo_1.CosmoDbService]}),__metadata("design:paramtypes",[service_cosmo_1.CosmoDbService])],a)}();exports.ResultSavingView=ResultSavingView;