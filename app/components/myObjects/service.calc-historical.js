/*! PILab 18-07-2021 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_result_1=require("../premisesCalcTest/model.result"),ModelPremisesHistoryChart=function(){function a(){this.Usd=new google.visualization.DataTable,this.Eur=new google.visualization.DataTable,this.Uah=new google.visualization.DataTable;for(var a=[this.Usd,this.Eur,this.Uah],b=0,c=a;b<c.length;b++){var d=c[b];d.addColumn("date","Date"),d.addColumn("number","Sale"),d.addColumn("number","Rent")}}return a}(),ModelCapRateSet=function(){function a(a,b){this.Rate=a,this.Mult=b}return a}(),ModelSingleRow=function(){function a(){}return a}(),ModelUIHistory=function(){function a(){this.PerSqm=new ModelPremisesHistoryChart,this.WholeObj=new ModelPremisesHistoryChart,this.FullResults=new Array}return a.prototype.AddResultRow=function(a){this.PerSqm.Usd.addRow(a.PerSqmUsd),this.WholeObj.Usd.addRow(a.WholeObjUsd),this.PerSqm.Eur.addRow(a.PerSqmEur),this.WholeObj.Eur.addRow(a.WholeObjEur),this.PerSqm.Uah.addRow(a.PerSqmUah),this.WholeObj.Uah.addRow(a.WholeObjUah),this.FullResults.push(a.FullResult)},a}();exports.ModelUIHistory=ModelUIHistory;var CalcHistoricalUI=function(){function a(a){this.opexCoef=.85,this.curssymb={usd:"$",eur:"€",uah:"₴"},this.DocExtractor=a}return a.prototype.CreateObjView=function(a){for(var b=this.DocExtractor.ExtractPremisesEvaluationObj(a),c=this.DocExtractor.ExtractPremisesSquare(a),d=new ModelUIHistory,e=0,f=b;e<f.length;e++){var g=f[e];d.AddResultRow(this.CreateFullResult(g,c))}return d},a.prototype.CreateFullResult=function(a,b){var c=new ModelSingleRow;c.FullResult=new model_result_1.ResultViewModel,c.FullResult.onDate=a.On,c.FullResult.usd.sale.sqm=this.CalcSingleVarSet(a.Sale,1,"usd"),c.FullResult.usd.sale.premises=this.CalcSingleVarSet(a.Sale,b,"usd"),c.FullResult.usd.rent.sqm=this.CalcSingleVarSet(a.Rent,1,"usd"),c.FullResult.usd.rent.premises=this.CalcSingleVarSet(a.Rent,b,"usd"),c.PerSqmUsd=new Array(a.On,a.Sale[2],a.Rent[2]),c.WholeObjUsd=new Array(a.On,a.Sale[2]*b,a.Rent[2]*b),c.FullResult.eur.sale.sqm=this.CalcSingleVarSet(a.Sale,a.CurEx[0],"eur"),c.FullResult.eur.sale.premises=this.CalcSingleVarSet(a.Sale,a.CurEx[0]*b,"eur"),c.FullResult.eur.rent.sqm=this.CalcSingleVarSet(a.Rent,a.CurEx[0],"eur"),c.FullResult.eur.rent.premises=this.CalcSingleVarSet(a.Rent,a.CurEx[0]*b,"eur"),c.PerSqmEur=new Array(a.On,a.Sale[2]*a.CurEx[0],a.Rent[2]*a.CurEx[0]),c.WholeObjEur=new Array(a.On,a.Sale[2]*a.CurEx[0]*b,a.Rent[2]*a.CurEx[0]*b),c.FullResult.hrn.sale.sqm=this.CalcSingleVarSet(a.Sale,a.CurEx[1],"uah"),c.FullResult.hrn.sale.premises=this.CalcSingleVarSet(a.Sale,a.CurEx[1]*b,"uah"),c.FullResult.hrn.rent.sqm=this.CalcSingleVarSet(a.Rent,a.CurEx[1],"uah"),c.FullResult.hrn.rent.premises=this.CalcSingleVarSet(a.Rent,a.CurEx[1]*b,"uah"),c.PerSqmUah=new Array(a.On,a.Sale[2]*a.CurEx[1],a.Rent[2]*a.CurEx[1]),c.WholeObjUah=new Array(a.On,a.Sale[2]*a.CurEx[1]*b,a.Rent[2]*a.CurEx[1]*b);var d=this.CalculateCapitalizRate(a);return c.FullResult.capitalizRate=d.Rate,c.FullResult.rentMultiplicator=d.Mult,c},a.prototype.CalcSingleVarSet=function(a,b,c){return new model_result_1.ResultVariationDataSet(this.IndicatorToString(a[0]*b,c),this.IndicatorToString(a[1]*b,c),this.IndicatorToString(a[2]*b,c))},a.prototype.CalculateCapitalizRate=function(a){var b=12*a.Rent[0]*this.opexCoef/a.Sale[2],c=12*a.Rent[2]*this.opexCoef/a.Sale[0],d=12*a.Rent[1]*this.opexCoef/a.Sale[1];return new ModelCapRateSet(this.CreateRateViewSet(b,c,d,!0),this.CreateRateViewSet(1/c,1/b,1/d,!1))},a.prototype.IndicatorToString=function(a,b){for(var c=String(Math.round(a)),d=c.length,e="",f=1;f<=d;f++)e=f%3==0&&f!=d?" "+c.charAt(d-f)+e:c.charAt(d-f)+e;return e=this.curssymb[b]+" "+e},a.prototype.CreateRateViewSet=function(a,b,c,d){return new model_result_1.ResultVariationDataSet(this.RateToString(a,d),this.RateToString(b,d),this.RateToString(c,d))},a.prototype.RateToString=function(a,b){return b?String(Math.round(1e3*a)/10)+"%":String(Math.round(10*a)/10)},a}();exports.CalcHistoricalUI=CalcHistoricalUI;