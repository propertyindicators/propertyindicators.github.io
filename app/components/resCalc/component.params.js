/*! PILab 18-07-2021 */

"use strict";var __decorate=this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g},__metadata=this&&this.__metadata||function(a,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),model_params_1=require("./model.params"),model_remstate_1=require("./model.remstate"),ParamsForm=function(){function a(){this.on_params_changed=new core_1.EventEmitter,this.headcolor="rgb(152,15,0)",this.params=new model_params_1.ParamsModel,this.objectKeys=Object.keys,this.square_str="",this.sqm_lable="кв.м",this.sqm_tip="общая площадь квартиры в кв.м, разделитель дробной части - точка",this.sqr_visible="none",this.remstate=new model_remstate_1.RemStateModel,this.reqparam={rooms:!0,floor:!1,square:!1,buildtype:!1,remclass:!1,devaluation:!1,avail:!1}}return a.prototype.ngOnInit=function(){$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()})},a.prototype.onRoomsIn=function(a){this.params.rooms=a,this.params.rooms_is=!0,this.params.square>0&&this.params.validateSqrRange(),""===this.params.square_err?this.sqr_visible="none":this.sqr_visible="block",this.params.schemaTypeRooms(),this.onModelChange()},a.prototype.onFloorIn=function(a){this.params.floor=a,this.params.floor_is=!0,this.onModelChange()},a.prototype.onBuildTypeIn=function(a){this.params.buildtype=a,this.params.buildtype_is=!0,this.params.square>0&&this.params.validateSqrRange(),""===this.params.square_err?this.sqr_visible="none":this.sqr_visible="block",this.params.schemaTypeRooms(),this.onModelChange()},a.prototype.onSqrChange=function(a){this.params.square_str=a,this.validateSquare(),this.params.square_is?this.sqr_visible="none":""===this.params.square_err?this.sqr_visible="none":this.sqr_visible="block",this.onModelChange()},a.prototype.onStateIn=function(a){this.params.state=a-1,this.params.state_is=!0,this.onModelChange()},a.prototype.onRemclassIn=function(a){this.remstate.remclass=Number(a),this.remstate.remclass_is=!0,this.validateState()},a.prototype.onDevaluationIn=function(a){this.remstate.devaluation=Number(a),this.remstate.devaluation_is=!0,this.validateState()},a.prototype.onAvailIn=function(a){this.remstate.avail=Number(a),this.remstate.avail_is=!0,this.validateState()},a.prototype.onModelChange=function(){this.on_params_changed.emit(this.params),this.highlightNextRequiredField()},a.prototype.highlightNextRequiredField=function(){var a=!1;this.params.rooms_is?this.reqparam.rooms=!1:(this.reqparam.rooms=!0,a=!0),this.params.floor_is||a?this.reqparam.floor=!1:(this.reqparam.floor=!0,a=!0),a||(this.params.square_is?this.reqparam.square=!1:this.params.square>0?this.params.buildtype_is?(this.reqparam.square=!0,a=!0):this.reqparam.square=!1:(this.reqparam.square=!0,a=!0)),this.params.buildtype_is||a?this.reqparam.buildtype=!1:(this.reqparam.buildtype=!0,a=!0),this.remstate.mainParametersAreFilled=!a,this.remstate.validateModel(this.reqparam)},a.prototype.validateSquare=function(){/^(\-|\+)?([0-9]+(\.[0-9]+)?|Infinity)$/.test(this.params.square_str)?(this.params.square=Number(this.params.square_str),this.params.validateSqrRange()):(this.params.square=0,this.params.square_is=!1,""===this.params.square_str?this.params.square_err="":this.params.square_err="*значение площади не является числовым")},a.prototype.validateState=function(){this.remstate.validateModel(this.reqparam),this.params.state=this.remstate.common_val,this.params.state_is=this.remstate.common_is,this.onModelChange()},__decorate([core_1.Output(),__metadata("design:type",Object)],a.prototype,"on_params_changed",void 0),a=__decorate([core_1.Component({selector:"comp-params",moduleId:module.id,templateUrl:"component.params.html",styleUrls:["component.addr.css"]})],a)}();exports.ParamsForm=ParamsForm;