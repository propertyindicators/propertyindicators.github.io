/*! PILab 11-05-2018 (c) 2017 propertyindicators@gmail.com */

var global=require("./_global"),macrotask=require("./_task").set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==require("./_cof")(process);module.exports=function(){var a,b,c,d=function(){var d,e;for(isNode&&(d=process.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(d){throw a?c():b=void 0,d}}b=void 0,d&&d.enter()};if(isNode)c=function(){process.nextTick(d)};else if(!Observer||global.navigator&&global.navigator.standalone)if(Promise&&Promise.resolve){var e=Promise.resolve(void 0);c=function(){e.then(d)}}else c=function(){macrotask.call(global,d)};else{var f=!0,g=document.createTextNode("");new Observer(d).observe(g,{characterData:!0}),c=function(){g.data=f=!f}}return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}};