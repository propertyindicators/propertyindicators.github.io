/*! PILab 18-07-2021 */

"use strict";var redefineAll=require("./_redefine-all"),getWeak=require("./_meta").getWeak,anObject=require("./_an-object"),isObject=require("./_is-object"),anInstance=require("./_an-instance"),forOf=require("./_for-of"),createArrayMethod=require("./_array-methods"),$has=require("./_has"),validate=require("./_validate-collection"),arrayFind=createArrayMethod(5),arrayFindIndex=createArrayMethod(6),id=0,uncaughtFrozenStore=function(a){return a._l||(a._l=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.a=[]},findUncaughtFrozen=function(a,b){return arrayFind(a.a,function(a){return a[0]===b})};UncaughtFrozenStore.prototype={get:function(a){var b=findUncaughtFrozen(this,a);if(b)return b[1]},has:function(a){return!!findUncaughtFrozen(this,a)},set:function(a,b){var c=findUncaughtFrozen(this,a);c?c[1]=b:this.a.push([a,b])},delete:function(a){var b=arrayFindIndex(this.a,function(b){return b[0]===a});return~b&&this.a.splice(b,1),!!~b}},module.exports={getConstructor:function(a,b,c,d){var e=a(function(a,f){anInstance(a,e,b,"_i"),a._t=b,a._i=id++,a._l=void 0,void 0!=f&&forOf(f,c,a[d],a)});return redefineAll(e.prototype,{delete:function(a){if(!isObject(a))return!1;var c=getWeak(a);return!0===c?uncaughtFrozenStore(validate(this,b)).delete(a):c&&$has(c,this._i)&&delete c[this._i]},has:function(a){if(!isObject(a))return!1;var c=getWeak(a);return!0===c?uncaughtFrozenStore(validate(this,b)).has(a):c&&$has(c,this._i)}}),e},def:function(a,b,c){var d=getWeak(anObject(b),!0);return!0===d?uncaughtFrozenStore(a).set(b,c):d[a._i]=c,a},ufstore:uncaughtFrozenStore};